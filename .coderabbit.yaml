# yaml-language-server: $schema=https://coderabbit.ai/integrations/schema.v2.json
chat:
  art: false
issue_enrichment:
  labeling:
    auto_apply_labels: true
    labeling_instructions:
      - label: "type: bug"
        instructions: |
          バグ、エラー、クラッシュ、誤った動作、予期しない結果を報告するIssue。ランタイムエラー、ロジックエラー、機能の破損、リグレッション、期待される動作からの逸脱などが含まれます。
      - label: "type: feature"
        instructions: |
          新機能の追加リクエスト。新しい機能、新しいコンポーネント、新しいAPIエンドポイント、新しいページなど、プロジェクトに新しい機能を追加する提案が含まれます。
      - label: "type: enhancement"
        instructions: |
          既存機能の改善リクエスト。パフォーマンス最適化、UI/UXの改善、コードの改善、より良いエラーハンドリング、より良いユーザー体験など、既存機能を改善する提案が含まれます。
      - label: "type: refactoring"
        instructions: |
          コードのリファクタリングに関するIssue。コードの再構築、コードの整理、アーキテクチャの改善、技術的負債の削減など、機能を変えずにコードの内部構造を改善する提案が含まれます。
      - label: "type: test"
        instructions: |
          テストに関するIssue。テストの追加、テストの改善、テストカバレッジの向上、テストの修正、E2Eテスト、ユニットテスト、統合テストなどが含まれます。
      - label: "type: documentation"
        instructions: |
          ドキュメントに関するIssue。ドキュメントの更新、追加、修正、明確化が必要なもの。欠落したドキュメント、古い情報、不明確な説明、APIドキュメント、コード例、READMEの改善などが含まれます。
      - label: "type: performance"
        instructions: |
          パフォーマンスに関するIssue。パフォーマンスの最適化、速度の改善、メモリ使用量の削減、レンダリングの最適化、バンドルサイズの削減、読み込み時間の短縮などが含まれます。
      - label: "type: security"
        instructions: |
          セキュリティに関するIssue。セキュリティの脆弱性、セキュリティの改善、脆弱性の報告、CVE、認証・認可の問題、データ保護、XSS、CSRF、SQLインジェクションなどが含まれます。
      - label: "scope: frontend"
        instructions: |
          フロントエンドに関するIssue。UIコンポーネント、ページ、スタイリング、クライアントサイドのロジック、Reactコンポーネント、Next.jsのページ、app/** または components/** ディレクトリに関連するものが含まれます。
      - label: "scope: backend"
        instructions: |
          バックエンドに関するIssue。サーバーサイドのロジック、API、データベース、認証、lib/** または app/api/** ディレクトリに関連するもの、Supabaseとの統合などが含まれます。
      - label: "scope: ci/cd"
        instructions: |
          CI/CDに関するIssue。GitHub Actions、ワークフロー、デプロイメント、ビルドプロセス、.github/** ディレクトリ内のファイル、自動化、継続的インテグレーション・デリバリーに関するものが含まれます。
      - label: "scope: tooling"
        instructions: |
          開発ツールや設定に関するIssue。biome.json、next.config.ts、tsconfig.json、vitest.config.ts、.coderabbit.yaml、postcss.config.mjs、components.jsonなどの設定ファイル、開発環境、リンター、フォーマッター、ビルドツールに関するものが含まれます。
      - label: "dependencies"
        instructions: |
          依存関係に関するIssue。パッケージの更新、依存関係の追加、依存関係の削除、package.json、pnpm-lock.yaml、セキュリティアップデート、バージョンアップグレードなどが含まれます。
      - label: "breaking change"
        instructions: |
          破壊的変更に関するIssue。後方互換性のない変更、APIの変更、既存のコードを壊す可能性のある変更、メジャーバージョンアップグレード、移行が必要な変更などが含まれます。
      - label: "priority: critical"
        instructions: |
          緊急対応が必要な問題。システムの停止、セキュリティの脆弱性、データ損失のリスク、本番環境での重大な障害など、即座に対応が必要な問題が含まれます。
      - label: "priority: high"
        instructions: |
          優先度が高い問題。主要機能の障害、ユーザー体験への大きな影響、重要な機能の欠如など、早急な対応が必要な問題が含まれます。
      - label: "priority: medium"
        instructions: |
          中程度の優先度の問題。マイナーな機能の障害、改善提案、通常の機能追加など、計画的に対応できる問題が含まれます。
      - label: "priority: low"
        instructions: |
          優先度が低い問題。UI/UXの微調整、ドキュメントの改善、将来的な改善提案など、時間のあるときに対応できる問題が含まれます。
      - label: "needs: discussion"
        instructions: |
          議論が必要なIssue。仕様の詳細、実装方法、アーキテクチャの決定など、チームでの議論が必要な提案や質問が含まれます。「どうすべきか」「意見を聞きたい」などの表現が含まれる場合に適用します。
      - label: "needs: reproduction"
        instructions: |
          再現手順が必要なIssue。バグ報告で具体的な再現手順が不足している場合、または報告者が再現方法を明確に示していない場合に適用します。
      - label: "good to have"
        instructions: |
          あると良い改善提案。必須ではないが、実装されればユーザー体験が向上する機能や改善。緊急性は低いが、将来的に実装を検討する価値がある提案が含まれます。
language: ja-JP
reviews:
  auto_apply_labels: true
  auto_review:
    ignore_usernames:
      - renovate[bot]
  in_progress_fortune: false
  labeling_instructions:
    - label: "scope: frontend"
      instructions: |
        app/** または components/** ディレクトリ内のファイルに変更が含まれる場合、このラベルを適用してください。
    - label: "scope: backend"
      instructions: |
        lib/** または app/api/** ディレクトリ内のファイルに変更が含まれる場合、このラベルを適用してください。
    - label: "scope: ci/cd"
      instructions: |
        .github/** ディレクトリ内のファイルまたはCI/CD設定ファイルに変更が含まれる場合、このラベルを適用してください。
    - label: "scope: tooling"
      instructions: |
        biome.json、next.config.ts、tsconfig.json、vitest.config.ts、.coderabbit.yaml、postcss.config.mjs、components.json などの設定ファイルに変更が含まれる場合、このラベルを適用してください。
    - label: "type: bug"
      instructions: |
        PRのタイトルまたは説明に「fix」「bug」「修正」「バグ」などのキーワードが含まれる場合、またはバグ修正を示す場合、このラベルを適用してください。
    - label: "type: feature"
      instructions: |
        PRのタイトルまたは説明に「feat」「add」「新機能」「追加」などのキーワードが含まれる場合、または新機能を示す場合、このラベルを適用してください。
    - label: "type: enhancement"
      instructions: |
        PRのタイトルまたは説明に「improve」「enhance」「改善」などのキーワードが含まれる場合、または改善を示す場合、このラベルを適用してください。
    - label: "type: refactoring"
      instructions: |
        PRのタイトルまたは説明に「refactor」「リファクタリング」などのキーワードが含まれる場合、またはコードのリファクタリングを示す場合、このラベルを適用してください。
    - label: "type: test"
      instructions: |
        テストファイル（**/__tests__/**、test/**、*.test.ts、*.test.tsx、*.spec.ts、*.spec.tsx）に変更が含まれる場合、このラベルを適用してください。
    - label: "type: documentation"
      instructions: |
        ドキュメントファイル（**/*.md、docs/**）に変更が含まれる場合、またはPRタイトルに「docs」が含まれる場合、このラベルを適用してください。
    - label: "type: performance"
      instructions: |
        PRのタイトルまたは説明に「perf」「performance」「optimize」「パフォーマンス」「最適化」などのキーワードが含まれる場合、このラベルを適用してください。
    - label: "type: security"
      instructions: |
        PRのタイトルまたは説明に「security」「vulnerability」「CVE」「セキュリティ」「脆弱性」などのキーワードが含まれる場合、このラベルを適用してください。
    - label: "dependencies"
      instructions: |
        package.json、pnpm-lock.yaml、またはその他の依存関係管理ファイルに変更が含まれる場合、このラベルを適用してください。
    - label: "breaking change"
      instructions: |
        PRのタイトルまたは説明に「breaking」「BREAKING CHANGE」「破壊的」などのキーワードが含まれる場合、または破壊的変更を示す場合、このラベルを適用してください。
    - label: "priority: critical"
      instructions: |
        緊急対応が必要なPR。本番環境の障害修正、セキュリティパッチ、データ損失の防止など、即座にマージが必要な変更が含まれます。PRのタイトルまたは説明に「hotfix」「urgent」「緊急」などのキーワードが含まれる場合に適用してください。
    - label: "priority: high"
      instructions: |
        優先度が高いPR。重要な機能の実装、主要なバグ修正、リリース予定の機能など、早急なレビューとマージが必要な変更が含まれます。
    - label: "priority: medium"
      instructions: |
        中程度の優先度のPR。通常の機能追加、改善、リファクタリングなど、計画的にレビューとマージができる変更が含まれます。
    - label: "priority: low"
      instructions: |
        優先度が低いPR。UI/UXの微調整、ドキュメントの更新、コメントの追加など、時間のあるときにレビューできる変更が含まれます。
    - label: "status: needs review"
      instructions: |
        レビュー待ちのPR。PRが作成されレビューが必要な状態、または変更が加えられて再レビューが必要な場合に適用してください。Draft PRには適用しないでください。
  path_instructions:
    - instructions: |
        各指摘コメントの冒頭には、必ずPull Requestの作成者（Author）へのメンションを含めてください。

        【メンションのルール】
        1. Authorが "copilot", "copilot[bot]", またはその他のCopilot関連のBotであると判断できる場合:
           必ず "@copilot" とメンションしてください。
        2. それ以外（人間のユーザー）の場合:
           Authorの正しいユーザー名（例: @username）をメンションしてください。

        形式例:
        "@copilot ここは修正が必要です..."
        "@user123 提案ですが..."

        理由:
        コメントの通知漏れを防ぐため、例外なくメンションが必要です。
      path: "**/*"
    - instructions: |
        ドキュメントファイルやメッセージファイルを変更する場合は、必ず `docs/STYLE_GUIDE.md` の内容を確認してください。

        【レビュー時の確認事項】
        1. 日本語の表記:
           - 括弧は半角 `()` を使用しているか（全角 `（）` は不可）
           - アルファベットの前後に不要な空白がないか（例: `GitHub アカウント` → `GitHubアカウント`）
           - 外来語の取り扱いが適切か（組織名・技術名はアルファベット、概念的な用語はカタカナ）
           - カタカナの長音符が適切に使用されているか（例: ユーザー、サーバー、エラー）

        2. 英語の表記:
           - Oxford comma が適切に使用されているか（3つ以上の項目のリスト）
           - 見出しが sentence case になっているか
           - 短縮形の使用が適切か（ユーザー向けメッセージは許可、法的文書は完全形）

        変更が STYLE_GUIDE.md に準拠していない場合は指摘してください。
      path: "**/*.{md,mdx}"
    - instructions: |
        メッセージファイルを変更する場合は、必ず `docs/STYLE_GUIDE.md` の内容を確認してください。

        【レビュー時の確認事項】
        1. 日本語の表記:
           - 括弧は半角 `()` を使用しているか（全角 `（）` は不可）
           - アルファベットの前後に不要な空白がないか
           - 外来語の取り扱いが適切か
           - カタカナの長音符が適切に使用されているか

        変更が STYLE_GUIDE.md に準拠していない場合は指摘してください。
      path: "messages/**/*.json"
    - instructions: |
        これらのファイルは shadcn/ui によって生成されたUIコンポーネントです。

        以下のルールに従ってレビューしてください：
        1. **重大なバグ**や**セキュリティ上の脆弱性**が見つかった場合のみ指摘してください。
        2. コードスタイル、型定義の厳密化、軽微なリファクタリング提案は**行わないでください**。
        3. もし指摘する場合は、それがshadcn/uiの標準実装から逸脱するリスクがないか考慮してください。
      path: "components/ui/**/*.tsx"
    - instructions: |
        このファイルは Supabase CLI によって自動生成された型定義ファイルです。

        以下のルールに従ってレビューしてください：
        1. **レビュー対象外**とし、指摘は行わないでください。
        2. 機械生成されたファイルのため、コードスタイルや型定義の指摘は不要です。
        3. もし問題がある場合は、データベーススキーマまたは生成コマンドの修正を提案してください。
      path: "types/supabase.ts"
  poem: false
  profile: chill
  request_changes_workflow: true
